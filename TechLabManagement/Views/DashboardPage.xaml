<Page x:Class="TechLabManagement.Views.DashboardPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    Title="Dashboard">
    <ScrollViewer>
        <Grid Margin="16">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>
            
            <!-- Header -->
            <StackPanel>
                <TextBlock Text="Tech Lab Dashboard" FontSize="22" FontWeight="Bold" Margin="0,0,0,8" />
                <TextBlock Text="Welcome! Use the menu above or quick actions below to navigate." 
                         FontSize="14" Foreground="Gray" Margin="0,0,0,16" />
            </StackPanel>

            <!-- Statistics Cards -->
            <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,16">
                <Border Width="220" Margin="0,0,16,0" Background="#E3F2FD" Padding="16" CornerRadius="4">
                    <StackPanel>
                        <TextBlock Text="Pending Access Requests" FontSize="13" Foreground="#1976D2" />
                        <TextBlock Text="{Binding PendingAccessCount}" FontSize="32" FontWeight="Bold" Foreground="#1565C0" />
                    </StackPanel>
                </Border>
                <Border Width="220" Margin="0,0,16,0" Background="#E8F5E9" Padding="16" CornerRadius="4">
                    <StackPanel>
                        <TextBlock Text="Bookings Today" FontSize="13" Foreground="#388E3C" />
                        <TextBlock Text="{Binding BookingsTodayCount}" FontSize="32" FontWeight="Bold" Foreground="#2E7D32" />
                    </StackPanel>
                </Border>
                <Border Width="220" Background="#FFF3E0" Padding="16" CornerRadius="4">
                    <StackPanel>
                        <TextBlock Text="Upcoming Maintenance" FontSize="13" Foreground="#F57C00" />
                        <TextBlock Text="{Binding DueMaintenanceCount}" FontSize="32" FontWeight="Bold" Foreground="#EF6C00" />
                    </StackPanel>
                </Border>
            </StackPanel>

            <!-- Quick Actions -->
            <GroupBox Grid.Row="2" Header="Quick Actions" Margin="0,0,0,16" Padding="12">
                <StackPanel Orientation="Horizontal">
                    <Button Content="📋 View All Labs" Click="NavigateToLabs_Click" 
                          Padding="16,12" Margin="0,0,12,0" 
                          Background="#2196F3" Foreground="White" FontSize="14" FontWeight="SemiBold"
                          Cursor="Hand" />
                    <Button Content="📝 Submit Access Request" Click="NavigateToAccessRequest_Click" 
                          Padding="16,12" Margin="0,0,12,0"
                          Background="#4CAF50" Foreground="White" FontSize="14" FontWeight="SemiBold"
                          Cursor="Hand" />
                    <Button Content="📅 Book Resource" Click="NavigateToBooking_Click" 
                          Padding="16,12" Margin="0,0,12,0"
                          Background="#FF9800" Foreground="White" FontSize="14" FontWeight="SemiBold"
                          Cursor="Hand" />
                    <Button Content="✅ Manage Approvals" Click="NavigateToApprovals_Click" 
                          Padding="16,12"
                          Background="#9C27B0" Foreground="White" FontSize="14" FontWeight="SemiBold"
                          Cursor="Hand" />
                </StackPanel>
            </GroupBox>

            <!-- Statistics and Activity -->
            <Grid Grid.Row="3">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="2*" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>

                <GroupBox Header="Top Labs by Booked Hours (next 7 days)" Margin="0,0,16,0">
                    <ItemsControl ItemsSource="{Binding TopLabStats}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Grid Margin="0,6">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="160" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="60" />
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="{Binding Name}" />
                                    <Border Grid.Column="1" Background="#FF5FA8" Height="14"
                                        Width="{Binding BarWidth}" />
                                    <TextBlock Grid.Column="2" Text="{Binding Hours}"
                                        HorizontalAlignment="Right" />
                                </Grid>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </GroupBox>

                <GroupBox Grid.Column="1" Header="Today">
                    <ListView ItemsSource="{Binding TodayBookings}">
                        <ListView.View>
                            <GridView>
                                <GridViewColumn Header="When" Width="120"
                                    DisplayMemberBinding="{Binding Start}" />
                                <GridViewColumn Header="Resource" Width="160"
                                    DisplayMemberBinding="{Binding ResourceName}" />
                                <GridViewColumn Header="User" Width="120"
                                    DisplayMemberBinding="{Binding UserName}" />
                            </GridView>
                        </ListView.View>
                    </ListView>
                </GroupBox>
            </Grid>
        </Grid>
    </ScrollViewer>
</Page>
