<Page x:Class="TechLabManagement.Views.AccessApprovalsPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    Title="Approvals">
    <Grid Margin="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>
        <TextBlock Text="Access Requests Approvals" FontSize="20" FontWeight="Bold" />

        <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,10,0,10">
            <TextBlock Text="Lab:" VerticalAlignment="Center" Margin="0,0,6,0" />
            <ComboBox Width="220" ItemsSource="{Binding Labs}" SelectedItem="{Binding SelectedLab}"
                DisplayMemberPath="Name" />
            <TextBlock Text="Manager:" VerticalAlignment="Center" Margin="16,0,6,0" />
            <ComboBox Width="220" ItemsSource="{Binding Managers}"
                SelectedItem="{Binding SelectedManager}" DisplayMemberPath="Name" />
            <Button Content="Export CSV" Margin="16,0,0,0" Command="{Binding ExportCsvCommand}" />
            <Button Content="Print" Command="{Binding PrintCommand}" />
        </StackPanel>

        <TabControl Grid.Row="2">
            <TabItem Header="Pending">
                <DataGrid ItemsSource="{Binding PendingRequests}" AutoGenerateColumns="False"
                    SelectedItem="{Binding SelectedRequest}">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Id" Binding="{Binding Id}" Width="220" />
                        <DataGridTextColumn Header="User" Binding="{Binding UserName}" Width="150" />
                        <DataGridTextColumn Header="Lab" Binding="{Binding LabName}" Width="160" />
                        <DataGridTextColumn Header="Reason" Binding="{Binding Reason}" Width="*" />
                        <DataGridTextColumn Header="Score" Binding="{Binding Score}" Width="60" />
                        <DataGridTemplateColumn Header="Actions" Width="160">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <StackPanel Orientation="Horizontal">
                                        <Button Content="Approve" Margin="0,0,6,0"
                                            Command="{Binding DataContext.ApproveCommand, RelativeSource={RelativeSource AncestorType=DataGrid}}" />
                                        <Button Content="Reject"
                                            Command="{Binding DataContext.RejectCommand, RelativeSource={RelativeSource AncestorType=DataGrid}}" />
                                    </StackPanel>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                    </DataGrid.Columns>
                </DataGrid>
            </TabItem>
            <TabItem Header="Approved">
                <DataGrid ItemsSource="{Binding ApprovedRequests}" AutoGenerateColumns="False">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Id" Binding="{Binding Id}" Width="220" />
                        <DataGridTextColumn Header="User" Binding="{Binding UserName}" Width="150" />
                        <DataGridTextColumn Header="Lab" Binding="{Binding LabName}" Width="160" />
                        <DataGridTextColumn Header="Reason" Binding="{Binding Reason}" Width="*" />
                        <DataGridTextColumn Header="Score" Binding="{Binding Score}" Width="60" />
                        <DataGridTextColumn Header="On" Binding="{Binding SubmittedAt}" Width="160" />
                    </DataGrid.Columns>
                </DataGrid>
            </TabItem>
            <TabItem Header="Rejected">
                <DataGrid ItemsSource="{Binding RejectedRequests}" AutoGenerateColumns="False">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Id" Binding="{Binding Id}" Width="220" />
                        <DataGridTextColumn Header="User" Binding="{Binding UserName}" Width="150" />
                        <DataGridTextColumn Header="Lab" Binding="{Binding LabName}" Width="160" />
                        <DataGridTextColumn Header="Reason" Binding="{Binding Reason}" Width="*" />
                        <DataGridTextColumn Header="Score" Binding="{Binding Score}" Width="60" />
                        <DataGridTextColumn Header="On" Binding="{Binding SubmittedAt}" Width="160" />
                    </DataGrid.Columns>
                </DataGrid>
            </TabItem>
        </TabControl>
    </Grid>
</Page>
