<Page x:Class="TechLabManagement.Views.ApprovalsPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    Title="Access Request Approvals">
    <Grid Margin="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <!-- Title -->
        <TextBlock Text="Access Request Approvals" FontSize="20" FontWeight="Bold" Margin="0,0,0,16" />

        <!-- Filters -->
        <Border Grid.Row="1" BorderBrush="#DDD" BorderThickness="1" Padding="12" Margin="0,0,0,16">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="200" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <!-- Lab Filter -->
                <TextBlock Grid.Column="0" Text="Filter by Lab:" VerticalAlignment="Center" Margin="0,0,8,0" />
                <ComboBox Grid.Column="1" ItemsSource="{Binding Labs}" 
                        SelectedItem="{Binding FilterLab}"
                        DisplayMemberPath="Name"
                        Margin="0,0,16,0" />

                <!-- Status Filter Buttons -->
                <TextBlock Grid.Column="2" Text="Status:" VerticalAlignment="Center" Margin="0,0,8,0" />
                <StackPanel Grid.Column="3" Orientation="Horizontal">
                    <Button Content="All" Command="{Binding ShowAllCommand}" Padding="8,4" Margin="0,0,4,0" />
                    <Button Content="Pending" Command="{Binding ShowPendingCommand}" Padding="8,4" Margin="0,0,4,0" Background="#FFA500" Foreground="White" BorderBrush="#FFA500" />
                    <Button Content="Approved" Command="{Binding ShowApprovedCommand}" Padding="8,4" Margin="0,0,4,0" Background="#4CAF50" Foreground="White" BorderBrush="#4CAF50" />
                    <Button Content="Rejected" Command="{Binding ShowRejectedCommand}" Padding="8,4" Margin="0,0,4,0" Background="#F44336" Foreground="White" BorderBrush="#F44336" />
                </StackPanel>

                <!-- Refresh -->
                <Button Grid.Column="4" Content="Refresh" Command="{Binding RefreshCommand}" Padding="8,4" Margin="8,0,0,0" />
            </Grid>
        </Border>

        <!-- Access Requests List -->
        <DataGrid Grid.Row="2" ItemsSource="{Binding AccessRequests}" 
                SelectedItem="{Binding SelectedRequest}"
                AutoGenerateColumns="False" 
                IsReadOnly="True"
                CanUserAddRows="False"
                CanUserDeleteRows="False"
                CanUserResizeRows="False"
                SelectionMode="Single">
            <DataGrid.Columns>
                <DataGridTextColumn Header="User" Binding="{Binding UserName}" Width="120" />
                <DataGridTextColumn Header="Lab" Binding="{Binding LabName}" Width="150" />
                <DataGridTextColumn Header="Team" Binding="{Binding TeamName}" Width="100" />
                <DataGridTextColumn Header="Reason" Binding="{Binding Request.Reason}" Width="*" />
                <DataGridTextColumn Header="Score" Binding="{Binding Request.Score, StringFormat='{}{0}%'}" Width="60" />
                <DataGridTextColumn Header="Submitted" Binding="{Binding SubmittedDate}" Width="140" />
                <DataGridTemplateColumn Header="Status" Width="100">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <Border Background="{Binding StatusColor}" Padding="4,2" CornerRadius="3">
                                <TextBlock Text="{Binding Request.Status}" Foreground="White" 
                                         FontWeight="Bold" HorizontalAlignment="Center" />
                            </Border>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
            </DataGrid.Columns>
        </DataGrid>

        <!-- Action Buttons -->
        <Border Grid.Row="3" BorderBrush="#DDD" BorderThickness="1,1,1,1" Padding="12" Margin="0,16,0,0">
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                <TextBlock Text="Select a request to approve or reject" VerticalAlignment="Center" Margin="0,0,16,0" Foreground="Gray" />
                <Button Content="Approve" Command="{Binding ApproveCommand}" 
                      Padding="12,6" Margin="0,0,8,0" 
                      Background="#4CAF50" Foreground="White" BorderBrush="#4CAF50" 
                      FontWeight="Bold" />
                <Button Content="Reject" Command="{Binding RejectCommand}" 
                      Padding="12,6" 
                      Background="#F44336" Foreground="White" BorderBrush="#F44336" 
                      FontWeight="Bold" />
            </StackPanel>
        </Border>
    </Grid>
</Page>

